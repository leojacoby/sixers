theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme(axis.text.x=element_text(angle=70,hjust=1,vjust=0.5)) +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team")
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme(axis.text.x=element_text(angle=70,hjust=0,vjust=0.5)) +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team")
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme(axis.text.x=element_text(angle=70,hjust=0.5,vjust=0.5)) +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team")
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team")
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team") +
theme_light()
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team") +
them_classic()
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team") +
theme_classic()
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team") +
theme_light()
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team") +
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team")
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team")
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
labs(x = "Team", y = "Favorites per tweet (non-replies)", title = "Favorites per tweet by team") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
labs(x = "Team", y = "Favorites per tweet", title = "Favorites per tweet by team for non-replies") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav, fill = media_type), stat = "identity") +
labs(x = "Team", y = "Favorites per tweet", title = "Favorites per tweet by team for non-replies") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_fav), y = avg_fav), stat = "identity") +
labs(x = "Team", y = "Favorites per tweet", title = "Favorites per tweet by team for non-replies") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -total_fav), y = total_fav), stat = "identity") +
labs(x = "Team", y = "Total favorites", title = "Total favorites by team for non-replies") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name) %>%
add_tally() %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T),
tweets = mean(n))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -total_fav), y = total_fav), stat = "identity") +
labs(x = "Team", y = "Total favorites", title = "Total favorites by team for non-replies") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
View(team_summary)
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name) %>%
# add_tally() %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T),
tweets = mean(n))
warnings()
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -total_fav), y = total_fav), stat = "identity") +
labs(x = "Team", y = "Total favorites", title = "Total favorites by team for non-replies") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name) %>%
add_tally() %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T),
tweets = mean(n))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -total_fav), y = total_fav), stat = "identity") +
labs(x = "Team", y = "Total favorites", title = "Total favorites by team for non-replies") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -avg_retweet), y = avg_retweet), stat = "identity") +
labs(x = "Team", y = "Retweets per tweet", title = "Retweets per tweet by team for non-replies") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -total_retweet), y = total_retweet), stat = "identity") +
labs(x = "Team", y = "Total retweets", title = "Total retweets by team for non-replies") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -total_retweet), y = total_retweet), stat = "identity") +
labs(x = "Team", y = "Number of tweets", title = "Number of tweets by team (non-replies only)") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(team_summary) +
geom_bar(aes(x = reorder(name, -tweets), y = tweets), stat = "identity") +
labs(x = "Team", y = "Number of tweets", title = "Number of tweets by team (non-replies only)") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
tmls <- tmls %>%
mutate(media_type = case_when(
grepl("photo", media_expanded_url) & !grepl("video", media_expanded_url) ~ "photo",
grepl("video", media_expanded_url) & !grepl("photo", media_expanded_url) ~ "video",
grepl("photo", media_expanded_url) & grepl("video", media_expanded_url) ~ "combo",
TRUE ~ "text"
))
ggplot(tmls) +
geom_bar(aes(x = reorder(name, -tweets)), fill = "media_type") +
labs(x = "Team", y = "Number of tweets", title = "Number of tweets by team (non-replies only)") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(tmls) +
geom_bar(aes(x = name), fill = "media_type") +
labs(x = "Team", y = "Number of tweets", title = "Number of tweets by team (non-replies only)") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(tmls) +
geom_bar(aes(x = name), fill = media_type) +
labs(x = "Team", y = "Number of tweets", title = "Number of tweets by team (non-replies only)") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
tmls <- tmls %>%
mutate(media_type = case_when(
grepl("photo", media_expanded_url) & !grepl("video", media_expanded_url) ~ "photo",
grepl("video", media_expanded_url) & !grepl("photo", media_expanded_url) ~ "video",
grepl("photo", media_expanded_url) & grepl("video", media_expanded_url) ~ "combo",
TRUE ~ "text"
))
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name) %>%
add_tally() %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T),
tweets = mean(n))
ggplot(tmls) +
geom_bar(aes(x = name), fill = media_type) +
labs(x = "Team", y = "Number of tweets", title = "Number of tweets by team (non-replies only)") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(tmls, aes(x = name)) +
geom_bar(aes(fill = media_type)) +
labs(x = "Team", y = "Number of tweets", title = "Number of tweets by team (non-replies only)") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(arrange(tmls, desc(n)), aes(x = name)) +
geom_bar(aes(fill = media_type)) +
labs(x = "Team", y = "Number of tweets", title = "Number of tweets by team (non-replies only)") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
tmls <- tmls %>%
mutate(media_type = case_when(
grepl("photo", media_expanded_url) & !grepl("video", media_expanded_url) ~ "photo",
grepl("video", media_expanded_url) & !grepl("photo", media_expanded_url) ~ "video",
grepl("photo", media_expanded_url) & grepl("video", media_expanded_url) ~ "combo",
TRUE ~ "text"
)) group_by(name) %>%
add_tally() %>%
ungroup()
tmls <- tmls %>%
mutate(media_type = case_when(
grepl("photo", media_expanded_url) & !grepl("video", media_expanded_url) ~ "photo",
grepl("video", media_expanded_url) & !grepl("photo", media_expanded_url) ~ "video",
grepl("photo", media_expanded_url) & grepl("video", media_expanded_url) ~ "combo",
TRUE ~ "text"
)) %>%
group_by(name) %>%
add_tally() %>%
ungroup()
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T),
tweets = mean(n))
ggplot(arrange(tmls, desc(n)), aes(x = name)) +
geom_bar(aes(fill = media_type)) +
labs(x = "Team", y = "Number of tweets", title = "Number of tweets by team (non-replies only)") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(reorder(tmls, n), aes(x = name)) +
geom_bar(aes(fill = media_type)) +
labs(x = "Team", y = "Number of tweets", title = "Number of tweets by team (non-replies only)") +
theme_light() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
tmls <- tmls %>%
mutate(media_type = case_when(
grepl("photo", media_expanded_url) & !grepl("video", media_expanded_url) ~ "photo",
grepl("video", media_expanded_url) & !grepl("photo", media_expanded_url) ~ "video",
grepl("photo", media_expanded_url) & grepl("video", media_expanded_url) ~ "combo",
TRUE ~ "text"
))
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally(name_media_count)
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally()
tmls <- tmls %>%
mutate(media_type = case_when(
grepl("photo", media_expanded_url) & !grepl("video", media_expanded_url) ~ "photo",
grepl("video", media_expanded_url) & !grepl("photo", media_expanded_url) ~ "video",
grepl("photo", media_expanded_url) & grepl("video", media_expanded_url) ~ "combo",
TRUE ~ "text"
))
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally()
tmls <- tmls %>% select(-n)
View(tmls)
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally()
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally() %>%
spread(media_type, n)
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally() %>%
spread(media_type, n) %>%
mutate(tweets = photo + video + text)
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally() %>%
ungroup() %>%
spread(media_type, n) %>%
mutate(tweets = photo + video + text)
tmls <- tmls %>%
mutate(media_type = case_when(
grepl("photo", media_expanded_url) & !grepl("video", media_expanded_url) ~ "photo",
grepl("video", media_expanded_url) & !grepl("photo", media_expanded_url) ~ "video",
grepl("photo", media_expanded_url) & grepl("video", media_expanded_url) ~ "combo",
TRUE ~ "text"
))
unique(tmls$media_type)
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally() %>%
ungroup() %>%
spread(media_type, n) %>%
mutate(tweets = photo + video + text)
team_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally() %>%
ungroup() %>%
spread(media_type, n) %>%
mutate(text = ifelse(is.na(text), 0, text),
tweets = photo + video + text)
type_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally() %>%
ungroup() %>%
spread(media_type, n) %>%
mutate(text = ifelse(is.na(text), 0, text),
tweets = photo + video + text)
engagement_type_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T),
tweets = mean(n))
warnings()
View(engagement_type_summary)
engagement_type_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T))
number_type_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally() %>%
ungroup() %>%
spread(media_type, n) %>%
mutate(text = ifelse(is.na(text), 0, text),
tweets = photo + video + text)
View(number_type_summary)
number_type_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally() %>%
ungroup()
?spread
aggregate(. = name + media_type,data = engagement_type_summary
aggregate(. = name + media_type,FUN = mean,data = engagement_type_summary)
aggregate
?aggregate
names(engagement_type_summary)
aggregate(. ~ name + media_type, FUN = mean,data = engagement_type_summary)
aggregate(. +  media_type ~ name, FUN = mean,data = engagement_type_summary)
aggregate(. ~ name * media_type, FUN = mean,data = engagement_type_summary)
?melt
library(reshape2)
?melt
melt(engagement_type_summary)
?dcast
m = melt(engagement_type_summary)
dcast(m,name + media_type ~ .)
dcast(m,name   ~ media_type)
dcast(m,name   ~ media_type, value.var = value)
m = melt(engagement_type_summary)
dcast(m,name   ~ media_type, value.var = 'value')
dcast(m,name ~ media_type)
tmp <- data.frame(x=gl(2,3, labels=letters[24:25]),
y=gl(3,1,6, labels=letters[1:3]),
z=c(1,2,3,3,3,2))
tmp
reshape(tmp, idvar="x", timevar="y", direction="wide")
m
reshape(m, idvar="name", timevar="media_type", direction="wide")
m
?reshape
reshape(m, idvar=c("name","media_type","variable"), direction="wide")
head(m)
reshape(m, idvar=c("name","media_type"), direction="wide")
reshape(m, idvar=c("name"), direction="wide")
reshape(tmp, idvar="x", timevar="y", direction="wide")
reshape(tmp, idvar=c("x"), timevar="y", direction="wide")
reshape(m, idvar=c("name"), timevar="name", direction="wide")
reshape(m, idvar=c("name"), timevar="media_type", direction="wide")
reshape(m, idvar=c("name","media_type"), timevar="variable", direction="wide")
reshape(m, idvar=c("name"), timevar="variable", direction="wide")
reshape(m, idvar=c("name"), timevar=c("variable",'media_type'), direction="wide")
reshape(m, idvar=c("name"), timevar=c("'media_type'), direction="wide")
reshape(m, idvar=c("name"), timevar=c('media_type'), direction="wide")
reshape(m, idvar=c("name",'variable'), timevar=c('media_type'), direction="wide")
m2 = reshape(m, idvar=c("name",'variable'), timevar=c('media_type'), direction="wide")
reshape(m2, idvar=c("name"), timevar=c('variable'), direction="wide")
dcast(m,name ~ media_type + variable)
m = melt(engagement_type_summary)
View(m)
m = melt(engagement_type_summary)
m2 <- dcast(m,name ~ media_type + variable)
View(m2)
View(m)
engagement_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name) %>%
summarize(all_avg_fav = mean(favorite_count, na.rm = T),
all_total_fav = sum(favorite_count, na.rm = T),
all_avg_retweet = mean(retweet_count, na.rm = T),
all_total_retweet = sum(retweet_count, na.rm = T))
engagement_type_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T))
engagement_type_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T))
long_data <- melt(engagement_type_summary)
engagement_type_summary <- dcast(m,name ~ media_type + variable)
number_type_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
tally() %>%
ungroup() %>%
spread(media_type, n) %>%
mutate(text = ifelse(is.na(text), 0, text),
tweets = photo + video + text)
engagement_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name) %>%
summarize(all_avg_fav = mean(favorite_count, na.rm = T),
all_total_fav = sum(favorite_count, na.rm = T),
all_avg_retweet = mean(retweet_count, na.rm = T),
all_total_retweet = sum(retweet_count, na.rm = T))
View(engagement_summary)
engagement_type_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T))
long_data <- melt(engagement_type_summary)
engagement_type_summary <- dcast(long_data,name ~ media_type + variable) %>%
mutate(text_total_fav = ifelse(is.na(text_total_fav), 0, text_total_fav),
text_total_retweet = ifelse(is.na(text_total_retweet), 0, text_total_retweet))
engagement_type_summary <- tmls %>%
filter(is.na(reply_to_status_id)) %>%
group_by(name, media_type) %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T))
long_data <- melt(engagement_type_summary)
engagement_type_summary <- dcast(long_data,name ~ media_type + variable)
number_type_summary <- tmls %>%
filter(is.na(reply_to_status_id) & !is_retweet) %>%
group_by(name, media_type) %>%
tally() %>%
ungroup() %>%
spread(media_type, n) %>%
mutate(text = ifelse(is.na(text), 0, text),
tweets = photo + video + text)
engagement_type_summary <- tmls %>%
filter(is.na(reply_to_status_id) & !is_retweet) %>%
group_by(name, media_type) %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T))
engagement_type_summary <- melt(engagement_type_summary)
engagement_type_summary <- dcast(long_data,name ~ media_type + variable) %>%
mutate(text_total_fav = ifelse(is.na(text_total_fav), 0, text_total_fav),
text_total_retweet = ifelse(is.na(text_total_retweet), 0, text_total_retweet))
engagement_type_summary <- tmls %>%
filter(is.na(reply_to_status_id) & !is_retweet) %>%
group_by(name, media_type) %>%
summarize(avg_fav = mean(favorite_count, na.rm = T),
total_fav = sum(favorite_count, na.rm = T),
avg_retweet = mean(retweet_count, na.rm = T),
total_retweet = sum(retweet_count, na.rm = T))
engagement_type_summary <- melt(engagement_type_summary)
engagement_type_summary <- dcast(engagement_type_summary,name ~ media_type + variable) %>%
mutate(text_total_fav = ifelse(is.na(text_total_fav), 0, text_total_fav),
text_total_retweet = ifelse(is.na(text_total_retweet), 0, text_total_retweet))
engagement_summary <- tmls %>%
filter(is.na(reply_to_status_id) & !is_retweet) %>%
group_by(name) %>%
summarize(all_avg_fav = mean(favorite_count, na.rm = T),
all_total_fav = sum(favorite_count, na.rm = T),
all_avg_retweet = mean(retweet_count, na.rm = T),
all_total_retweet = sum(retweet_count, na.rm = T))
?cbind
full_join(engagement_summary, number_type_summary, by = "name")
tidy_data <- full_join(number_type_summary, engagement_summary, engagement_type_summary by = "name")
tidy_data <- full_join(number_type_summary, engagement_summary, engagement_type_summary, by = "name")
View(tidy_data)
tidy_data <- full_join(engagement_summary, engagement_type_summary, by = "name")
tidy_data <- full_join(number_type_summary, tidy_engagement_data, by = "name")
tidy_engagement_data <- full_join(engagement_summary, engagement_type_summary, by = "name")
tidy_data <- full_join(number_type_summary, tidy_engagement_data, by = "name")
table(filter(tmls, grepl("pelicans", tolower(name)))$is.retweet)
table(filter(tmls, grepl("pelicans", tolower(name)))$is_retweet)
table(filter(tmls, grepl("pelicans", tolower(name)))$reply_to_status_id)
source('~/programming/R/Sixers/tweets/tweet_analysis.R')
setwd("/Users/leojacoby/programming/R/Sixers/tweets/data")
save(tidy_data, file = "tidy_data.RData")
setwd("/Users/leojacoby/programming/R/Sixers/tweets")
load("data/tidy_data.RData")
load("data/tidy_data.RData")
View(tidy_data)
source('~/programming/R/Sixers/tweets/tweet_analysis.R')
